(function(n){function f(f,e){var o=e.Canvas;t==null&&(r=o.prototype.getTextInfo,u=o.prototype.addText,t=o.prototype.render);o.prototype.render=function(){var n,u,l,e,a,r,v,o,h,p,c,w;if(!f.getOptions().canvas)return t.call(this);n=this.context;u=this._textCache;n.save();n.textBaseline="middle";for(l in u)if(i.call(u,l)){e=u[l];for(a in e)if(i.call(e,a)){r=e[a];v=!0;for(o in r)if(i.call(r,o)){var s=r[o],y=s.positions,b=s.lines;for(v&&(n.fillStyle=s.font.color,n.font=s.font.definition,v=!1),h=0;p=y[h];h++)if(p.active)for(c=0;w=p.lines[c];c++)n.fillText(b[c].text,w[0],w[1]);else y.splice(h--,1);y.length==0&&delete r[o]}}}n.restore()};o.prototype.getTextInfo=function(t,i,u,e,o){var c,l,a,h,v,s,p,y,w,b;if(!f.getOptions().canvas)return r.call(this,t,i,u,e,o);if(i=""+i,c=typeof u=="object"?u.style+" "+u.variant+" "+u.weight+" "+u.size+"px "+u.family:u,l=this._textCache[t],l==null&&(l=this._textCache[t]={}),a=l[c],a==null&&(a=l[c]={}),h=a[i],h==null){for(v=this.context,typeof u!="object"&&(s=n("<div>&nbsp;<\/div>").css("position","absolute").addClass(typeof u=="string"?u:null).appendTo(this.getTextLayer(t)),u={lineHeight:s.height(),style:s.css("font-style"),variant:s.css("font-variant"),weight:s.css("font-weight"),family:s.css("font-family"),color:s.css("color")},u.size=s.css("line-height",1).height(),s.remove()),c=u.style+" "+u.variant+" "+u.weight+" "+u.size+"px "+u.family,h=a[i]={width:0,height:0,positions:[],lines:[],font:{definition:c,color:u.color}},v.save(),v.font=c,p=(i+"").replace(/<br ?\/?>|\r\n|\r/g,"\n").split("\n"),y=0;y<p.length;++y)w=p[y],b=v.measureText(w),h.width=Math.max(b.width,h.width),h.height+=u.lineHeight,h.lines.push({text:w,width:b.width,height:u.lineHeight});v.restore()}return h};o.prototype.addText=function(n,t,i,r,e,o,s,h,c){var l,a,y;if(!f.getOptions().canvas)return u.call(this,n,t,i,r,e,o,s,h,c);var v=this.getTextInfo(n,r,e,o,s),p=v.positions,w=v.lines;for(i+=v.height/w.length/2,i=c=="middle"?Math.round(i-v.height/2):c=="bottom"?Math.round(i-v.height):Math.round(i),!(window.opera&&window.opera.version().split(".")[0]<12)||(i-=2),a=0;l=p[a];a++)if(l.x==t&&l.y==i){l.active=!0;return}for(l={active:!0,lines:[],x:t,y:i},p.push(l),a=0;y=w[a];a++)h=="center"?l.lines.push([Math.round(t-y.width/2),i]):h=="right"?l.lines.push([Math.round(t-y.width),i]):l.lines.push([Math.round(t),i]),i+=y.height}}var t,r,u,i=Object.prototype.hasOwnProperty;n.plot.plugins.push({init:f,options:{canvas:!0},name:"canvas",version:"1.0"})})(jQuery);
//# sourceMappingURL=jquery.flot.canvas.min.js.map
